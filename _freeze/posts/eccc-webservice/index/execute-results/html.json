{
  "hash": "50c57fa07d9c39a8314d34c833c7bc2c",
  "result": {
    "markdown": "---\ntitle: The return of the webservice\nauthor: Sam Albers\ndate: '2023-04-25'\nslug: eccc-webservice\ncategories:\n  - R\n  - hydrology\n  - tidyhydat\ntags: []\ndescription: ''\nfeatured: ''\nfeaturedalt: ''\nfeaturedpath: ''\nlinktitle: ''\ntype: post\n---\n\n\n\n\n\nThe most common question I get about the tidyhydat package goes something like this: \n\n> How do I get realtime data longer than the 30 days available in the datamart via [`realtime_dd`](https://docs.ropensci.org/tidyhydat/reference/realtime_dd.html)?\n\nPreviously the answer was... you can't. The HYDAT database is a historical database. Data are validated and entered into HYDAT periodically. It is not updated in realtime. At the same time realtime data is only available for 30 days from the datamart. \n\nNow, however, Environment and Climate Change Canada (ECCC) provided a [webservice](https://wateroffice.ec.gc.ca/services/links_e.html) that provides realtime data for stations which extends back to about 18 months. This usually spans the gap to get data into HYDAT. And since tidyhydat version 0.6.0 you can now access this data in R via the `realtime_ws` function. This lost is a quick introduction to some of the usage of that webservice from tidyhydat. \n\nLet's load a few packages to help illustrate this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyhydat)\nlibrary(gt)\nlibrary(dplyr)\nlibrary(lubridate)\n```\n:::\n\n\n## Getting realtime hydrometric data\n\nThe `realtime_ws` function operates in a similar way to the `realtime_dd` function. You can get data for a single station or for a list of stations and the function returns a tibble. Here I am assuming that you know which station you and know its number. For an introduction to tidyhydat see [this vignette](https://docs.ropensci.org/tidyhydat/articles/tidyhydat_an_introduction.html). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nws <- realtime_ws(\n  station_number = \"02JE032\"\n)\nglimpse(ws)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 8,784\nColumns: 10\n$ STATION_NUMBER <chr> \"02JE032\", \"02JE032\", \"02JE032\", \"02JE032\", \"02JE032\", …\n$ Date           <dttm> 2023-03-27 00:00:00, 2023-03-27 00:05:00, 2023-03-27 0…\n$ Name_En        <chr> \"Water level (primary sensor)\", \"Water level (primary s…\n$ Value          <dbl> 6.556, 6.556, 6.553, 6.553, 6.551, 6.550, 6.549, 6.550,…\n$ Unit           <chr> \"m\", \"m\", \"m\", \"m\", \"m\", \"m\", \"m\", \"m\", \"m\", \"m\", \"m\", …\n$ Grade          <chr> \"-1\", \"-1\", \"-1\", \"-1\", \"-1\", \"-1\", \"-1\", \"-1\", \"-1\", \"…\n$ Symbol         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ Approval       <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ Parameter      <dbl> 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46,…\n$ Code           <chr> \"HG\", \"HG\", \"HG\", \"HG\", \"HG\", \"HG\", \"HG\", \"HG\", \"HG\", \"…\n```\n:::\n:::\n\n::: {.cell .column-margin}\n::: {.cell-output-display}\n```{=html}\n<div id=\"kdxfcvgabt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kdxfcvgabt table {\n  font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kdxfcvgabt thead, #kdxfcvgabt tbody, #kdxfcvgabt tfoot, #kdxfcvgabt tr, #kdxfcvgabt td, #kdxfcvgabt th {\n  border-style: none;\n}\n\n#kdxfcvgabt p {\n  margin: 0;\n  padding: 0;\n}\n\n#kdxfcvgabt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #FFFFFF;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #231409;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kdxfcvgabt .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #231409;\n  border-bottom-width: 0;\n}\n\n#kdxfcvgabt .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #231409;\n  border-top-width: 0;\n}\n\n#kdxfcvgabt .gt_heading {\n  background-color: #231409;\n  text-align: center;\n  border-bottom-color: #231409;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #231409;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kdxfcvgabt .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #231409;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kdxfcvgabt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kdxfcvgabt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kdxfcvgabt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kdxfcvgabt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kdxfcvgabt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #231409;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kdxfcvgabt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #231409;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kdxfcvgabt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kdxfcvgabt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kdxfcvgabt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kdxfcvgabt .gt_stub {\n  color: #FFFFFF;\n  background-color: #231409;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kdxfcvgabt .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #231409;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kdxfcvgabt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kdxfcvgabt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kdxfcvgabt .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #231409;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kdxfcvgabt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kdxfcvgabt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #231409;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kdxfcvgabt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kdxfcvgabt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #231409;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kdxfcvgabt .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #231409;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kdxfcvgabt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kdxfcvgabt .gt_left {\n  text-align: left;\n}\n\n#kdxfcvgabt .gt_center {\n  text-align: center;\n}\n\n#kdxfcvgabt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kdxfcvgabt .gt_font_normal {\n  font-weight: normal;\n}\n\n#kdxfcvgabt .gt_font_bold {\n  font-weight: bold;\n}\n\n#kdxfcvgabt .gt_font_italic {\n  font-style: italic;\n}\n\n#kdxfcvgabt .gt_super {\n  font-size: 65%;\n}\n\n#kdxfcvgabt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kdxfcvgabt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kdxfcvgabt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kdxfcvgabt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kdxfcvgabt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kdxfcvgabt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kdxfcvgabt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Name_En\">Name_En</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">46</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water level (primary sensor)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">16</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water level (secondary sensor, telemetry)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">11</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water level (secondary sensor)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">52</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water level (tertiary sensor, telemetry)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">13</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water level (tertiary sensor)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water level (daily mean)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">39</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water level (hourly mean)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">14</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Elevation, natural lake</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">42</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Elevation, lake or reservoir rule curve</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">17</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Atmospheric pressure</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">18</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Accumulated precipitation</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">19</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Incremental precipitation</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">47</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Discharge (primary sensor derived)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Discharge (secondary sensor derived)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Discharge (tertiary sensor derived)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Discharge (daily mean)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">40</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Discharge (hourly mean)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Discharge (sensor)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">50</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Snow depth</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">51</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Snow depth, new snowfall</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Air temperature</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water temperature</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">41</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Secondary water temperature</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">34</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Wind direction</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">35</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Wind speed</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Battery voltage</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">20</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Blue-green algae</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">21</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Conductance</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">26</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Total dissolved solids</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">43</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Dissolved nitrate</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">22</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Dissolved oxygen</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">24</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">pH</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">25</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Turbidity</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water velocity</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">37</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water velocity, x</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">38</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Water velocity, y</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">23</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Oxygen saturation</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">49</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Chlorophyll</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">28</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Relative humidity</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">36</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Cell end</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Internal equipment temperature</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_right\">12</td>\n<td headers=\"Name_En\" class=\"gt_row gt_left\">Tank pressure</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nImmediately you can see that the data returned is different than the data returned by `realtime_dd`. In particular notice the `Name_En`, `Parameter` and `Code` columns. These columns are used to identify the parameters we are interested in. Turns out off that you can access more than just hydrometric data via the webservice (more on that later!). But for now let's just focus on hydrometric data by supplying 47 to the parameter argument to get discharge. Why did I choose 47? I used the `param_id` internal table which tells me that 47 is the parameter code for discharge. In the margin you can see all the other parameters available.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nws_discharge <- realtime_ws(\n  station_number = \"02JE032\",\n  parameter = 46\n)\n```\n:::\n\n\nSo how many months back does this data go?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrange(ws_discharge$Date)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2023-03-27 00:00:00 UTC\" \"2023-04-26 23:55:00 UTC\"\n```\n:::\n:::\n\n\nWait - I told you that this would extend back 18 months. What gives? Well the default data range for `realtime_ws` is 30 days. You can change this by supplying a `start_date` and `end_date` argument. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nws_discharge <- realtime_ws(\n  station_number = \"02JE032\",\n  parameter = c(46, 5),\n  start_date = Sys.Date() - months(18),\n  end_date = Sys.Date()\n)\n\nrange(ws_discharge$Date)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2021-10-26 00:00:00 UTC\" \"2023-04-26 23:55:00 UTC\"\n```\n:::\n:::\n\n\nNow that's much better. From here you can make beautiful plots, tables and summaries of that glorious 18 months of data. \n\n## Other Parameters\n\nI did however promise that I would mention something about the other parameters available. The long table to the right lists all the possible parameters. In the water office, you can see, sort of, which parameters are available for a given station. However it is lots of clicking. I currently don't know of an _easy_ way to determine which parameters are available for a given station other than just by checking. So for that I'd recommend a workflow like this:\n\nQuery a station for a short duration:\n\n::: {.cell}\n\n```{.r .cell-code}\nother_params <- realtime_ws(\n  station_number = \"08MF005\",\n  start_date = Sys.Date() - days(1),\n)\n\nparam_id[param_id$Parameter %in% unique(other_params$Parameter),]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 7\n  Parameter Code  Unit  Name_En            Name_Fr Description_En Description_Fr\n      <dbl> <chr> <chr> <chr>              <chr>   <chr>          <chr>         \n1        46 HG    m     Water level (prim… Niveau… Height, stage… Hauteur, nive…\n2        47 QR    m3/s  Discharge (primar… Debit … Discharge - f… Débit - écoul…\n3         5 TW    °C    Water temperature  Tempér… Temperature, … Température, …\n```\n:::\n:::\n\n\nThen you can see which parameters are available for that station. \n\n\n::: {.cell}\n\n:::\n\n\n\nSo once you chosen your measure you can see if your station has data for that measure. So a good first step is to grab all the stations that are also reporting in realtime\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstations <- realtime_stations()\nstations\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,061 × 6\n   STATION_NUMBER STATION_NAME   LATITUDE LONGITUDE PROV_TERR_STATE_LOC TIMEZONE\n   <chr>          <chr>             <dbl>     <dbl> <chr>               <chr>   \n 1 01AD003        ST. FRANCIS R…     47.2     -69.0 NB                  UTC-04:…\n 2 01AD004        SAINT JOHN RI…     47.4     -68.3 NB                  UTC-04:…\n 3 01AF002        SAINT JOHN RI…     47.0     -67.7 NB                  UTC-04:…\n 4 01AF007        GRANDE RIVIER…     47.2     -67.9 NB                  UTC-04:…\n 5 01AF009        IROQUOIS RIVE…     47.5     -68.4 NB                  UTC-04:…\n 6 01AG003        AROOSTOOK RIV…     46.8     -67.8 NB                  UTC-04:…\n 7 01AH002        TOBIQUE RIVER…     47.2     -67.2 NB                  UTC-04:…\n 8 01AJ003        MEDUXNEKEAG R…     46.2     -67.7 NB                  UTC-04:…\n 9 01AJ004        BIG PRESQUE I…     46.4     -67.7 NB                  UTC-04:…\n10 01AJ010        BECAGUIMEC ST…     46.3     -67.5 NB                  UTC-04:…\n# ℹ 2,051 more rows\n```\n:::\n:::\n\n\nOk so 2061 stations are reporting in realtime. There is no direct way to see \n\n::: {.cell}\n\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}